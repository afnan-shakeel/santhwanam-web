<!-- Custody Balance Card -->
<div class="bg-linear-to-br from-primary-700 via-primary-800 to-primary-900 rounded-2xl shadow-xl overflow-hidden">
  <div class="p-6 sm:p-8">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
      <!-- Balance Info -->
      <div>
        <div class="flex items-center gap-2">
          <svg class="w-6 h-6 text-primary-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p class="text-sm font-medium text-primary-200 uppercase tracking-wider">Current Balance</p>
        </div>
        <p class="text-4xl sm:text-5xl font-bold mt-2 text-white">{{ formatCurrency(balance) }}</p>

        <!-- Stats Row -->
        <div class="mt-4 flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-primary-200">
          <span>Total Received: <span class="font-semibold text-white">{{ formatCurrency(totalReceived) }}</span></span>
          <span class="hidden sm:inline">|</span>
          <span>Total Transferred: <span class="font-semibold text-white">{{ formatCurrency(totalTransferred) }}</span></span>
        </div>

        <!-- Last Activity -->
        <div class="mt-3 flex items-center gap-2 text-sm">
          @if (isOverdue) {
            <span class="inline-flex items-center gap-1.5 bg-amber-500/20 border border-amber-400/30 rounded-lg px-3 py-1.5">
              <svg class="w-4 h-4 text-amber-300" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
              </svg>
              <span class="text-amber-100">Last Activity: {{ getRelativeTime(lastActivityDate) }}</span>
            </span>
          } @else {
            <span class="text-primary-200">
              Last Activity: <span class="font-medium text-white">{{ getRelativeTime(lastActivityDate) }}</span>
            </span>
          }
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col gap-3">
        @if (showTransferButton) {
          <button (click)="initiateTransfer.emit()"
            class="flex items-center justify-center gap-2 bg-white text-primary-700 font-semibold px-6 py-3 rounded-xl shadow-lg hover:bg-primary-50 hover:shadow-xl transition-all duration-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9l4 3m0 0l-4 3m4-3H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            Initiate Handover
          </button>
        }

        @if (showReminderButton) {
          <button (click)="sendReminder.emit()"
            class="flex items-center justify-center gap-2 bg-white/20 text-white font-semibold px-6 py-3 rounded-xl border border-white/30 hover:bg-white/30 transition-all duration-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
            Send Reminder
          </button>
        }
      </div>
    </div>
  </div>
</div>
